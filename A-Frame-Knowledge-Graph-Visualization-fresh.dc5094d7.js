const RACE_NAMES={men:"Men",elves:"Elves",hobbit:"Hobbit",dwarf:"Dwarf",ainur:"Ainur",ents:"Ent",orcs:"Orc",animal:"Animal"};AFRAME.registerComponent("graph-interaction",{schema:{infoPanelId:{type:"string",default:"info-panel"},graphContainerId:{type:"string",default:"graph-container"}},init:function(){this.selectedNodeId=null,this.hoveredNodeId=null,this.graphLoader=null,this.infoPanel=null,this.isHoverLocked=!1,this.onNodeMouseEnter=this.onNodeMouseEnter.bind(this),this.onNodeMouseLeave=this.onNodeMouseLeave.bind(this),this.onNodeClick=this.onNodeClick.bind(this),this.onBackgroundClick=this.onBackgroundClick.bind(this),this.onGraphLoaded=this.onGraphLoaded.bind(this),this.el.addEventListener("graph-loaded",this.onGraphLoaded)},onGraphLoaded:function(e){console.log("[GraphInteraction] Graph loaded, setting up interactions");let t=document.getElementById(this.data.graphContainerId);t&&(this.graphLoader=t.components["graph-loader"]),this.infoPanel=document.getElementById(this.data.infoPanelId),this.setupNodeListeners(),this.onBackgroundHover=this.onBackgroundHover.bind(this);let i=document.querySelector("#background");i&&(i.addEventListener("click",this.onBackgroundClick),i.addEventListener("mouseenter",this.onBackgroundHover));let o=document.querySelector("a-sky");o&&(o.addEventListener("click",this.onBackgroundClick),o.addEventListener("mouseenter",this.onBackgroundHover))},onBackgroundHover:function(e){this.hoveredNodeId&&this.hoveredNodeId!==this.selectedNodeId&&this.resetNodeAppearance(this.hoveredNodeId),this.hoveredNodeId=null,this.selectedNodeId?this.showInfoPanel(this.selectedNodeId):this.hideInfoPanel()},setupNodeListeners:function(){let e=document.querySelectorAll(".graph-node");e.forEach(e=>{e.addEventListener("mouseenter",this.onNodeMouseEnter),e.addEventListener("mouseleave",this.onNodeMouseLeave),e.addEventListener("click",this.onNodeClick)}),console.log("[GraphInteraction] Set up listeners for",e.length,"nodes")},onNodeMouseEnter:function(e){let t=e.target,i=t.getAttribute("data-node-id");if(i&&this.hoveredNodeId!==i){if(this.hoveredNodeId&&this.hoveredNodeId!==this.selectedNodeId&&this.resetNodeAppearance(this.hoveredNodeId),this.hoveredNodeId=i,i!==this.selectedNodeId){t.setAttribute("scale","1.2 1.2 1.2");let e=t.getAttribute("data-node-color");t.setAttribute("material","emissive",e||"#ffffff"),t.setAttribute("material","emissiveIntensity",.3)}this.showInfoPanel(i)}},onNodeMouseLeave:function(e){let t=e.target.getAttribute("data-node-id");t&&(t!==this.selectedNodeId&&this.resetNodeAppearance(t),this.hoveredNodeId===t&&(this.hoveredNodeId=null),this.selectedNodeId?this.showInfoPanel(this.selectedNodeId):this.hideInfoPanel())},resetNodeAppearance:function(e){let t=this.graphLoader?this.graphLoader.getNodeEntity(e):null;if(t)if(t.setAttribute("scale","1 1 1"),this.selectedNodeId)if(this.isNodeConnected(e,this.selectedNodeId)){let i=window.graphData.nodeMap[e];t.setAttribute("material","color",i?.color||"#7A84DD"),t.setAttribute("material","opacity",1),t.setAttribute("material","emissive","#000000"),t.setAttribute("material","emissiveIntensity",0)}else t.setAttribute("material","color","#444444"),t.setAttribute("material","opacity",.3),t.setAttribute("material","emissive","#000000"),t.setAttribute("material","emissiveIntensity",0);else{let i=window.graphData.nodeMap[e];t.setAttribute("material","color",i?.color||"#7A84DD"),t.setAttribute("material","opacity",1),t.setAttribute("material","emissive","#000000"),t.setAttribute("material","emissiveIntensity",0)}},isNodeConnected:function(e,t){return e===t||window.graphData.links.some(i=>i.source===t&&i.target===e||i.target===t&&i.source===e)},clearHover:function(){this.hoveredNodeId&&(this.resetNodeAppearance(this.hoveredNodeId),this.hoveredNodeId=null,this.hideInfoPanel())},onNodeClick:function(e){e.stopPropagation();let t=e.target.getAttribute("data-node-id");t&&(this.selectedNodeId===t?this.deselectNode():this.selectNode(t))},onBackgroundClick:function(e){this.clearHover(),this.selectedNodeId&&this.deselectNode()},selectNode:function(e){if(this.selectedNodeId&&this.selectedNodeId!==e&&this.graphLoader&&this.graphLoader.resetHighlight(),this.hoveredNodeId===e){let t=this.graphLoader?this.graphLoader.getNodeEntity(e):null;t&&t.setAttribute("scale","1 1 1")}this.selectedNodeId=e,this.hoveredNodeId=null,this.graphLoader&&this.graphLoader.highlightNode(e),this.showInfoPanel(e),this.el.emit("node-selected",{nodeId:e})},deselectNode:function(){let e=this.selectedNodeId;this.selectedNodeId=null,this.graphLoader&&this.graphLoader.resetHighlight(),this.hideInfoPanel(),this.el.emit("node-deselected",{nodeId:e})},showInfoPanel:function(e){if(!this.infoPanel||!window.graphData.nodeMap)return;let t=window.graphData.nodeMap[e];if(!t)return;let i=this.getNodeConnections(e),o=this.infoPanel.querySelector("#panel-name"),n=this.infoPanel.querySelector("#panel-race"),s=this.infoPanel.querySelector("#panel-gender"),d=this.infoPanel.querySelector("#panel-weight"),r=this.infoPanel.querySelector("#panel-connections"),a=this.infoPanel.querySelector("#panel-top-connections");if(o&&o.setAttribute("value",t.label),n&&n.setAttribute("value",RACE_NAMES[t.race]||t.race),s){let e=t.gender?t.gender.charAt(0).toUpperCase()+t.gender.slice(1):"-";s.setAttribute("value",e)}if(d&&d.setAttribute("value",t.weight.toString()),r){let e=t.total_connections||i.length;r.setAttribute("value",e.toString())}if(a){let e=i.slice(0,5).map(e=>`${e.label} (${e.weight})`).join("\n");a.setAttribute("value",e||"None")}this.infoPanel.setAttribute("visible",!0)},hideInfoPanel:function(){this.infoPanel&&this.infoPanel.setAttribute("visible",!1)},getNodeConnections:function(e){if(!window.graphData.links)return[];let t=[];return window.graphData.links.forEach(i=>{if(i.source===e){let e=window.graphData.nodeMap[i.target];e&&t.push({id:i.target,label:e.label,weight:i.weight})}else if(i.target===e){let e=window.graphData.nodeMap[i.source];e&&t.push({id:i.source,label:e.label,weight:i.weight})}}),t.sort((e,t)=>t.weight-e.weight)},capitalizeFirst:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):"-"},remove:function(){document.querySelectorAll(".graph-node").forEach(e=>{e.removeEventListener("mouseenter",this.onNodeMouseEnter),e.removeEventListener("mouseleave",this.onNodeMouseLeave),e.removeEventListener("click",this.onNodeClick)});let e=document.querySelector("#background");e&&e.removeEventListener("click",this.onBackgroundClick)}}),console.log("[GraphInteraction] Component registered");
//# sourceMappingURL=A-Frame-Knowledge-Graph-Visualization-fresh.dc5094d7.js.map
